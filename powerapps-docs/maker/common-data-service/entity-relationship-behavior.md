---
title: 関連付け動作エンティティ (アプリ用 Common Data Service) | Microsoft Docs
description: <Description>
ms.custom: ''
ms.date: 08/01/2018
ms.reviewer: ''
ms.service: powerapps
ms.topic: article
author: Mattp123
ms.author: matp
manager: kvivek
---
# <a name="entity-relationship-behavior"></a>エンティティ関係の動作

関連エンティティの動作は、データ整合性が確保され、会社の業務プロセスを自動化できるため重要です。

## <a name="preserve-data-integrity"></a>データ整合性の維持

他のエンティティをサポートするために存在するエンティティもあります。 それらは単独では意味がありません。 通常は、サポートする主エンティティにリンクするための検索フィールドが必須です。 プライマリ レコードが削除されると、どうなりますか。

関連付けの動作を使用し、ビジネスのルールに基づいてこれを定義することができます。 2 つのオプション:

- 異なる主エンティティと関連付けることなどによって、関連するエンティティレコードを調整できるようにするため、主エンティティの削除を防止します。
- 主エンティティ レコードを削除して、関連エンティティを自動的に削除できるようにします。

関連エンティティが主エンティティをサポートしていない場合は、主エンティティを削除することができ、検索の値は消去されます。

## <a name="automate-business-processes"></a>ビジネス プロセスの自動化
  
新しい営業担当者がいて、別の営業担当者に割り当てている既存の取引先企業をその新しい営業担当者に割り当てると仮定します。 各取引先企業レコードには、それに関連付けられた一連タスク活動があります。 以前の所有者に再割り当てしたいまたは新しい営業担当者に割り当てたいアクティブな取引先企業を簡単に見つけることができます。 しかし、取引先企業に関連付けられているタスク活動の場合にはどうですか。 各タスクを開き、新しい営業担当者に割り当てるかどうかを一つずつ考慮したいですか。 したくないでしょう。 その代わり、関連付けが標準規則を自動的に適用するようにできます。 これらの規則は再割り当てする取引先企業に関連付けられているタスク レコードにのみ適用されます。 次のオプションがあります。  
  
- すべてのタスク活動を再割り当てします。  
- すべてのタスクを再割り当てします。 
- タスクを全く再割り当てしません。  
- 現時点では、すべてのタスクを取引先企業の以前の所有者に再割り当てします。  
  
関連付けは、主エンティティ レコードのレコードで実行された操作が関連するすべてのエンティティ レコードにどのように伝播するかを制御できます。  

## <a name="behaviors"></a>動作

特定の操作を実行するときに適用できる複数の種類の動作があります。

|動作|説明|
|--|--|
|**アクティブ レコードのみに伝播**|すべてのアクティブな関連エンティティ レコードで操作を実行します。|
|**すべてのレコードに伝播**|すべての関連エンティティ レコードで操作を実行します。|
|**伝播しない**|何もしません。|
|**関連付けの解除**|すべての関連レコードの検索値を削除します。|
|**制限する**|関連エンティティ レコードが存在するときは、主エンティティ レコードが削除されないようにします。|
|**同一所有者のレコードのみに伝播**|主エンティティ レコードと同じユーザーによって所有されているすべての関連エンティティ レコードで操作を実行します。|

## <a name="actions"></a>操作

これらは、特定の動作をトリガーできる操作です。

|フィールド|説明|Options|
|--|--|--|
|**割り当て**|主エンティティ レコードが別のレコードに割り当てられると、どうなりますか?|すべてのレコードに伝播<br />アクティブ レコードのみに伝播<br />同一所有者のレコードのみに伝播<br />伝播しない|
|**リペアレント**|上位下位の関連付けの関連エンティティの検索値が変更されると、どうなりますか。<br />詳細情報: [エンティティの上位下位の関連付け](#parental-entity-relationships)|すべてのレコードに伝播<br />アクティブ レコードのみに伝播<br />同一所有者のレコードのみに伝播<br />伝播しない|
|**共有**|主エンティティ レコードが共有されると、どうなりますか。|すべてのレコードに伝播<br />アクティブ レコードのみに伝播<br />同一所有者のレコードのみに伝播<br />伝播しない|
|**削除**|主エンティティ レコードが削除されると、どうなりますか。|すべてのレコードに伝播<br />リンクの解除<br />制限する|
|**共有の解除**|主エンティティ レコードの共有が解除されると、どうなりますか。|すべてのレコードに伝播<br />アクティブ レコードのみに伝播<br />同一所有者のレコードのみに伝播<br />伝播しない|
|**マージ**|主エンティティ レコードの共有がマージされると、どうなりますか。|すべてのレコードに伝播<br />伝播しない|
|**ロールアップ ビュー**|この関連付けに関連付けられているロールアップ ビューの希望する動作は何ですか。 |すべてのレコードに伝播<br />アクティブ レコードのみに伝播<br />同一所有者のレコードのみに伝播<br />伝播しない|


## <a name="parental-entity-relationships"></a>エンティティの上位下位の関連付け

1:N の関連付けを持つことができるエンティティの各ペアの間には、1:N の関連付けが複数存在する場合があります。 その場合でも、エンティティの上位下位の関連付けを考慮できるのは、通常、そのような関連付けの中の 1 つだけです。

エンティティの上位下位の関連付けは、次の表の**上位下位である**列のカスケード オプションのいずれかが真であるような、1:N のエンティティの関連付けです。

|目的|上位下位である|上位下位ではない|  
|------------|--------------|------------------|  
|**割り当て**|すべてのレコードに伝播<br />同一所有者のレコードのみに伝播<br />アクティブ レコードのみに伝播|伝播しない|  
|**削除**|すべてのレコードに伝播|リンクの解除<br />制限する|  
|**リペアレント**|すべてのレコードに伝播<br />同一所有者のレコードのみに伝播<br />アクティブ レコードのみに伝播|伝播しない|  
|**共有**|すべてのレコードに伝播<br />同一所有者のレコードのみに伝播<br />アクティブ レコードのみに伝播|伝播しない|  
|**共有の解除**|すべてのレコードに伝播<br />同一所有者のレコードのみに伝播<br />アクティブ レコードのみに伝播|伝播しない|  

たとえば、新しい顧客エンティティを作成し、取引先企業エンティティとの 1:N のエンティティ関係を追加して、顧客エンティティが関連エンティティである場合、**上位下位である**列のオプションを使用するように、そのエンティティ関係に対する操作を構成できます。 後で、顧客エンティティとの別の 1:N エンティティ関係を、顧客エンティティを参照元エンティティとして追加する場合は、**上位下位ではない**列のオプションを使用するような操作だけを構成できます。

通常、これは各エンティティ ペアには上位下位の関連付けが 1 つだけ存在することを意味します。 複数の種類のエンティティに対して、関連エンティティでの関連付けの検索を実行できる場合があります。

たとえば、エンティティに顧客検索がある場合、取引先担当者または取引先企業エンティティを参照できます。 2 つの異なる上位下位の 1:N エンティティ関係が存在します。

すべての活動エンティティには、関係する検索フィールドを使用して関連付けることができるエンティティに対する、似た一連のエンティティの上位下位の関連付けがあります。

<a name="BKMK_RelationshipBehaviorLimitations"></a>   

## <a name="limitations-on-behaviors-you-can-set"></a>設定できる動作の制限
  
上位下位の関連付けのため、エンティティ関係を定義するときを覚えておく必要があるいくつかの制限があります。  
  
- 伝播する関連システム エンティティとの関連付けにおいて、ユーザー定義エンティティを主エンティティにすることはできません。 つまり、主ユーザー定義エンティティと関連システム エンティティの間の関連付けには、**すべてのレコードに伝播**、**アクティブ レコードのみに伝播**、または**同一所有者のレコードのみに伝播**のアクションを設定できません。  
- アクションが**すべてのレコードに伝播**、**アクティブ レコードのみに伝播**、または**同一所有者のレコードのみに伝播**に設定された別の関連付けの関連エンティティとして、新しい関連付けの関連エンティティが既に存在する場合、新しい関連付けのアクションを**すべてのレコードに伝播**、**アクティブ レコードのみに伝播**、または**同一所有者のレコードのみに伝播**に設定することはできません。 これにより、複数の親関連付けを持つ関連付けの作成を防ぎます。  
