---
title: 埋め込みキャンバス アプリで現在のレコードをデータ コンテキストとして渡す | MicrosoftDocs
ms.custom: ''
ms.date: 12/17/2018
ms.reviewer: ''
ms.service: powerapps
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: get-started-article
applies_to:
  - Dynamics 365 (online)
  - Dynamics 365 Version 9.x
  - PowerApps
author: Aneesmsft
ms.author: matp
manager: kvivek
tags:
  - PowerApps maker portal impact
search.audienceType:
  - maker
search.app:
  - PowerApps
  - D365CE
---

# <a name="pass-the-current-record-as-data-context-to-an-embedded-canvas-app"></a>埋め込みキャンバス アプリに現在のレコードをデータ コンテキストとして渡す
このトピックでは、埋め込みキャンバス アプリを追加して、現在の (メイン フォーム) レコードをデータ コンテキストとして埋め込みキャンバス アプリに渡す方法を説明します。

> [!NOTE]
> この機能は現在はプレビュー中です。 <br />
> [!INCLUDE [cc-preview-features-definition](../../includes/cc-preview-features-definition.md)] 

埋め込みキャンバス アプリを取引先企業のメイン フォーム上に追加して、現在の取引先企業レコードを埋め込みキャンバス アプリに渡すことを想定します。 これを行うには、次の手順を実行します。 

1.  [PowerApps](https://web.powerapps.com/?utm_source=padocs&utm_medium=linkinadoc&utm_campaign=referralsfromdoc) にサインインして、取引先企業エンティティなどのエンティティのメイン フォームのためにフォーム エディターを開きます。 
2.  埋め込みキャンバス アプリを表示するフォーム上のセクションを選択します。
3.  フィールド エクスプローラー ウィンドウを使用して、**取引先企業名**などの必須フィールドを追加します。
      > [!IMPORTANT]
      > 必ず値を持つ必須フィールドを常に使用します。 フィールドに値がない場合、埋め込みキャンバス アプリはホストのモデル駆動型フォーム上のデータが変更されるときにリフレッシュされません。
4.  選択したフィールドで、**ホーム** タブの **編集**グループで、**プロパティの変更**を選択します。
5.  **フィールド プロパティ** ダイアログ ボックスで、**コントロール** タブを選択します。
6.  **コントロール** タブで、**コントロールの追加...** を選択します。
7.  **コントロールの追加** ダイアログ ボックスの、使用可能なコントロールの一覧で、**キャンバス アプリ** を選択してから **追加** を選択します。
8.  **フィールド プロパティ** ダイアログ ボックスの、コントロールの一覧で **キャンバス アプリ** を選択してから、**Web** オプションを選択します。
9.  コントロール リストの下部のセクションに、キャンバス アプリ コントロールで使用可能なプロパティのリストが表示されます。
     - **エンティティ名**プロパティは、埋め込みキャンバス アプリにデータを提供するエンティティを指定します。 これは、以前のステップで追加したフィールドを含むエンティティにセットされます。
         - このプロパティが変更可能として表示される場合であっても、それに対する変更が埋め込みキャンバス アプリ上に影響を与えないことに注意してください。 それは参照することのみを目的としています。
     - **アプリ ID** プロパティは埋め込みキャンバス アプリの ID を指定します。 これはキャンバス アプリが作成されるときに自動的に生成および入力されます。
         - **アプリ ID** の値を変更すると、モデル駆動型フォームから埋め込みキャンバス アプリへのリンクが切断されることに注意してください。
10. キャンバス アプリを作成または編集するには**カスタマイズ**を選択します。 これにより PowerApps Studio が新しいタブで開きます。
       > [!NOTE]
       > PowerApps Studio を開くことが Web ブラウザーのポップアップ ブロッカーのためにブロックされる場合、web.powerapps.com サイトを有効にするか、一時的にポップアップ ブロッカーを無効にしてから、再び**カスタマイズ**を選択します。
11. PowerApps Studio の、左のウィンドウに、特別な **ModelDrivenFormIntegration** コントロールがあることに注意してください。 このコントロールは、ホストのモデル駆動型フォームから埋め込みキャンバス アプリにコンテキスト データを取り込みます。
12. **Gallery1** コントロールを選択して、**アイテム** プロパティに **ModelDrivenFormIntegration.Data** がセットされていることを確認します。
      > [!NOTE]
      > ModelDrivenFormIntegration.Data はレコードのリストです。 この例ではレコードは 1 つのみです。 直接レコードを参照するには、First 関数を使用することができます。 たとえば、*First(ModelDrivenFormIntegration.Data).Name* です。
13. プロパティ ウィンドウの右の、**フィールド**の横の、**編集**を選択します。
14. データ ウィンドウで、**Title1** コントロールにマッピングされたフィールドを**名前**に変更、またはデータを持つ他のフィールドに変更します。
15. ギャラリーに、ホストのモデル駆動型フォームから ModelDrivenFormIntegration コントロールを介して渡されるデータが表示されることを確認します。 データ ウィンドウを閉じます。
16. **ファイル** タブを選択してから、**アプリの設定**を選択します。
17. **詳細設定**タブの、 **実験機能**セクションで、**ユーザー エクスペリエンスを埋め込むアプリを有効にする**を**オン**にセットします。
18. **保存**を選択します。 
19. **クラウド** タブを選択します。アプリに一意の名前をつけてから右下にある**保存**を選択します。 以下に注意します。 
    -  アプリを初めて保存するときは、アプリが自動的に公開されます。
      -  それ以降の保存時には、**公開**を選択してから**このバージョンを公開**を選択し、変更を有効にします。
20. メニュー上で**戻る**を選択してから、フォーム エディターを開いたブラウザー タブを選択します。 キャンバス アプリ コントロールの**アプリ ID** プロパティの値が自動的に入力されたことを確認します。 以下に注意します。 
    -   フォーム エディターには以前のステップで他のブラウザー タブで開いた PowerApps Studio とのダイレクト リンクがあります。
    -   フォーム エディターは送信される**アプリ ID** を「リスニング」します。
    -   **アプリ ID** はアプリが保存されるときにエディターから送信されます。
21. **フィールド プロパティ** ダイアログ ボックスで、**表示**タブを選択します。
22. フォーム上の**ラベルの表示**をクリアしてから **OK** を選択します。
    -   このフォームに埋め込まれたキャンバス アプリが既にある場合は、「1 つのフォームで 1 つのキャンバス アプリのみを有効にすることができます。」というメッセージが表示されます。 新しいキャンバス アプリを追加するには、まず[現在の埋め込みキャンバス アプリを無効化](embedded-canvas-app-guidelines.md#disable-an-embedded-canvas-app)する必要があります。 次に、[新しい埋め込みキャンバス アプリを有効化](embedded-canvas-app-guidelines.md#enable-an-embedded-canvas-app)します。
23. **ホーム** タブで、**保存**を選択してから、**公開**を選択します。

埋め込みキャンバス アプリを自分のモデル駆動型フォームに追加した後、埋め込みキャンバス アプリを他のユーザーと共有します。 詳細: [埋め込みキャンバス アプリの共有](share-embedded-canvas-app.md)。

修正したフォームを含むモデル駆動型アプリ (統一インターフェイスのみ) を開くと、埋め込みキャンバス アプリがフォーム上に表示されます。 メイン フォームに表示されるレコードを変更すると、フォームに渡されたデータ コンテキストが変更され、関連するデータを表示するように埋め込みアプリがリフレッシュされます。

このトピックは、モデル駆動型フォームで埋め込みキャンバス アプリを使用する方法を説明しました。 さまざまなデータ ソースに接続してデータを取り込むように、埋め込みキャンバス アプリをさらにカスタマイズすることができます。 フィルター、検索、およびルックアップ機能、およびホストのモデル駆動型フォームからフィルターから渡されたコンテキストを使用して、これらのデータ ソース内の特定のレコードをフィルター処理または検索します。 WYSIWYG キャンバス アプリ エディターを使用して、ユーザーの環境に合ったインターフェイスを簡単に設計します。

## <a name="see-also"></a>関連項目
[モデル駆動型フォーム上にキャンバス アプリを埋め込む](embed-canvas-app-in-form.md) <br />
[関連付けられたレコードのリストをデータ コンテキストとして埋め込みキャンバス アプリに渡す](pass-related-embedded-canvas-app.md) <br />
[組み込みキャンバス アプリ内からホスト フォームで事前定義済みの操作を実行する](embedded-canvas-app-actions.md) <br />
[埋め込みキャンバス アプリの共有](share-embedded-canvas-app.md)。 <br />
[埋め込みキャンバス アプリの作業のガイドライン](embedded-canvas-app-guidelines.md)
